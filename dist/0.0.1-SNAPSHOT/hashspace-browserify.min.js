require=function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);throw new Error("Cannot find module '"+g+"'")}var j=c[g]={exports:{}};b[g][0].call(j.exports,function(a){var c=b[g][1][a];return e(c?c:a)},j,j.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({"hsp/$set":[function(a,b){b.exports=a("+0srr9")},{}],"+0srr9":[function(a,b){function c(a){if(!g.test(a))throw new Error("Invalid operator: "+a);return f[a]=Function("a","b","a"+a+"b;return a;")}var d=a("./json"),e=b.exports=function(a,b,c){return d.$set(a,b,c)};e.del=d.$delete;var f={},g=/^([-+*%\/&^|]|<<|>>|>>>)?=$/;e.op=function(a,b,d,g){var h=f[d]||c(d);return e(a,b,h(a[b],g))},e.inc=function(a,b){var c=a[b];return e(a,b,c+1),c},e.dec=function(a,b){var c=a[b];return e(a,b,c-1),c}},{"./json":"YcvKH8"}],WDacIY:[function(a,b){var c=window.document;b.exports.createDocumentFragment=function(){return c.createDocumentFragment()},b.exports.createElement=function(a){return c.createElement(a)},b.exports.createElementNS=function(a,b){return c.createElementNS(a,b)},b.exports.createTextNode=function(a){return c.createTextNode(a)},b.exports.createComment=function(a){return c.createComment(a)},b.exports.getElementById=function(a){return c.getElementById(a)},c.createEvent&&(b.exports.createEvent=function(){return c.createEvent.apply(c,arguments)}),c.createEventObject&&(b.exports.createEventObject=function(){return c.createEventObject.apply(c,arguments)})},{}],"hsp/document":[function(a,b){b.exports=a("WDacIY")},{}],hhHoZL:[function(){Array.prototype.indexOf||(Array.prototype.indexOf=function(a){"use strict";if(null==this)throw new TypeError;var b=Object(this),c=b.length>>>0;if(0===c)return-1;var d=0;if(arguments.length>1&&(d=Number(arguments[1]),d!=d?d=0:0!==d&&1/0!=d&&d!=-1/0&&(d=(d>0||-1)*Math.floor(Math.abs(d)))),d>=c)return-1;for(var e=d>=0?d:Math.max(c-Math.abs(d),0);c>e;e++)if(e in b&&b[e]===a)return e;return-1}),Function.prototype.bind||(Function.prototype.bind=function(a){if("function"!=typeof this)throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable");var b=Array.prototype.slice.call(arguments,1),c=this,d=function(){},e=function(){return c.apply(this instanceof d&&a?this:a,b.concat(Array.prototype.slice.call(arguments)))};return d.prototype=this.prototype,e.prototype=new d,e})},{}],"hsp/es5":[function(a,b){b.exports=a("hhHoZL")},{}],"6Kl1kt":[function(a,b){var c=a("../klass"),d=a("./touchEvent"),e=a("./gesture").Gesture,f=c({$extends:e,MARGIN:10,BETWEEN_DELAY:200,_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:this._doubleTapStart.bind(this)}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:this._doubleTapMove.bind(this)},{evt:this.touchEventMap.touchend,cb:this._doubleTapEnd.bind(this)}]},_getFakeEventsMap:function(){return{doubletapstart:"doubletapstart",cancel:"doubletapcancel",finalize:"doubletap"}},_doubleTapStart:function(a){var b=this._gestureStart(a);return null==b?this.timerId?this._doubleTapCancel(a):null!=a.returnValue?a.returnValue:!a.defaultPrevented:this.timerId?(clearTimeout(this.timerId),b):this._raiseFakeEvent(a,this._getFakeEventsMap().doubletapstart)},_doubleTapMove:function(a){var b=d.getPositions(a);if(this.MARGIN>=this._calculateDistance(this.startData.positions[0].x,this.startData.positions[0].y,b[0].x,b[0].y)){var c=this._gestureMove(a);return null==c?this._doubleTapCancel(a):c}return this._doubleTapCancel(a)},_doubleTapEnd:function(a){var b=this._gestureEnd(a);if(null==b)return this._doubleTapCancel(a);if(this.timerId)return this.timerId=null,this._raiseFakeEvent(a,this._getFakeEventsMap().finalize);var c=this,d={};for(var e in a)d[e]=a[e];return this.timerId=setTimeout(function(){c._doubleTapFinalCancel(d)},this.BETWEEN_DELAY),b},_doubleTapCancel:function(a){return this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this._gestureCancel(a)},_doubleTapFinalCancel:function(a){return this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this._raiseFakeEvent(a,this._getFakeEventsMap().cancel)}});b.exports.DoubleTap=f},{"../klass":"GfSJC6","./gesture":"xsjChN","./touchEvent":"oYuPY+"}],"hsp/gestures/doubleTap":[function(a,b){b.exports=a("6Kl1kt")},{}],J6s4RB:[function(a,b){var c=a("../klass"),d=a("./touchEvent"),e=a("./gesture").Gesture,f=c({$extends:e,_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:this._dragStart.bind(this)}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:this._dragMove.bind(this)},{evt:this.touchEventMap.touchend,cb:this._dragEnd.bind(this)}]},_getFakeEventsMap:function(){return{dragstart:"dragstart",dragmove:"dragmove",dragend:"drag",cancel:"dragcancel"}},_dragStart:function(a){var b=null!=this.currentData,c=this._gestureStart(a);return null==c&&b?(this.currentData={positions:d.getPositions(a),time:(new Date).getTime()},this._raiseFakeEvent(a,this._getFakeEventsMap().cancel)):null==c?null!=a.returnValue?a.returnValue:!a.defaultPrevented:c},_dragMove:function(a){var b=null!=this.currentData,c=this._gestureMove(a);if(null!=c){var d=this._getFakeEventsMap().dragstart;return b&&(d=this._getFakeEventsMap().dragmove),this._raiseFakeEvent(a,d)}return this.currentData=null,b?this._gestureCancel(a):null!=a.returnValue?a.returnValue:!a.defaultPrevented},_dragEnd:function(a){var b=null!=this.currentData,c=this._gestureEnd(a);return b?null==c?null!=a.returnValue?a.returnValue:!a.defaultPrevented:this._raiseFakeEvent(a,this._getFakeEventsMap().dragend):null!=a.returnValue?a.returnValue:!a.defaultPrevented}});b.exports.Drag=f},{"../klass":"GfSJC6","./gesture":"xsjChN","./touchEvent":"oYuPY+"}],"hsp/gestures/drag":[function(a,b){b.exports=a("J6s4RB")},{}],xsjChN:[function(a,b){var c=a("../klass"),d=a("./touchEvent"),e=c({NB_TOUCHES:1,$constructor:function(a,b){this.target=a,this.evthandler=b,this.touchEventMap=d.touchEventMap,this.eventsAlreadyAttached=!1,this.timerId=null,this.startData=null,this.currentData=null,this.callbackMap={},this._connectTouchEvents()},$dispose:function(){this._disconnectTouchEvents(),this.callbackMap=null},_connectTouchEvents:function(){if(!this.eventsAlreadyAttached){for(var a=this._getInitialListenersList(),b=0;b<a.length;b++)this._addListener(a[b].evt,a[b].cb);this.eventsAlreadyAttached=!0}},_disconnectTouchEvents:function(){for(var a=this._getInitialListenersList(),b=0;b<a.length;b++)this._removeListener(a[b].evt,a[b].cb);this.eventsAlreadyAttached=!1},_getInitialListenersList:function(){return[]},_getAdditionalListenersList:function(){return[]},_getFakeEventsMap:function(){return{}},_gestureStart:function(a,b){return this.__validateNbTouches(a)?(this._disconnectTouchEvents(),this.startData={positions:d.getPositions(a),time:(new Date).getTime()},this.currentData=null,this._connectAdditionalTouchEvents(),this._getFakeEventsMap().start?this._raiseFakeEvent(a,this._getFakeEventsMap().start,b):null!=a.returnValue?a.returnValue:!a.defaultPrevented):null},_gestureMove:function(a,b){return this.__validateNbTouches(a)?(this.currentData={positions:d.getPositions(a),time:(new Date).getTime()},this._getFakeEventsMap().move?this._raiseFakeEvent(a,this._getFakeEventsMap().move,b):null!=a.returnValue?a.returnValue:!a.defaultPrevented):null},_gestureEnd:function(a,b){return this.__validateNbTouches(a)?(this._disconnectAdditionalTouchEvents(),this._connectTouchEvents(),this.currentData={positions:d.getPositions(a),time:(new Date).getTime()},this._getFakeEventsMap().end?this._raiseFakeEvent(a,this._getFakeEventsMap().end,b):null!=a.returnValue?a.returnValue:!a.defaultPrevented):null},_gestureCancel:function(a,b){return this._disconnectAdditionalTouchEvents(),this._connectTouchEvents(),this.currentData={positions:d.getPositions(a),time:(new Date).getTime()},this._getFakeEventsMap().cancel?this._raiseFakeEvent(a,this._getFakeEventsMap().cancel,b):null!=a.returnValue?a.returnValue:!a.defaultPrevented},_connectAdditionalTouchEvents:function(){for(var a=this._getAdditionalListenersList(),b=0;b<a.length;b++)this._addListener(a[b].evt,a[b].cb)},_disconnectAdditionalTouchEvents:function(){for(var a=this._getAdditionalListenersList(),b=0;b<a.length;b++)this._removeListener(a[b].evt,a[b].cb)},_addListener:function(a,b){this.callbackMap[a]=b;var c=void 0!==this.target.addEventListener;if(!c){var d=this;this._attachEventFn=function(a){d.handleEvent(a)}}c?this.target.addEventListener(a,this,!1):this.target.attachEvent("on"+a,this._attachEventFn)},handleEvent:function(a){if(this.callbackMap[a.type]){var b=this.callbackMap[a.type];if(b)return b(a)}},_removeListener:function(a){this.callbackMap[a]=null;var b=void 0!==this.target.removeEventListener;b?this.target.removeEventListener(a,this,!1):this.target.detachEvent("on"+a,this._attachEventFn)},_raiseFakeEvent:function(a,b,c){var e=a.target?a.target:a.srcElement,f=d.getFakeEvent(b,e);a.returnValue||f.preventDefault(),a.cancelBubble&&f.stopPropagation(),f.pageX=a.pageX,f.pageY=a.pageY,f.clientX=a.clientX,f.clientY=a.clientY,f.touches=a.touches,f.changedTouches=a.changedTouches,f.isPrimary=a.isPrimary,this.startData&&this.startData.time&&(f.duration=(new Date).getTime()-this.startData.time),c||(c={}),c.startX=this.startData.positions[0].x,c.startY=this.startData.positions[0].y;var g=d.getPositions(a);return c.currentX=g[0].x,c.currentY=g[0].y,f.detail=c,this.evthandler.handleEvent(f),a.cancelBubble=f.hasStopPropagation,a.returnValue=!f.hasPreventDefault,a.returnValue},_calculateDistance:function(a,b,c,d){return Math.sqrt(Math.pow(c-a,2)+Math.pow(d-b,2))},__validateNbTouches:function(a){var b=d.getFingerIndex(a);return 1==this.NB_TOUCHES&&0===b||2==this.NB_TOUCHES&&b>=0}});b.exports.Gesture=e},{"../klass":"GfSJC6","./touchEvent":"oYuPY+"}],"hsp/gestures/gesture":[function(a,b){b.exports=a("xsjChN")},{}],"hsp/gestures/gestures":[function(a,b){b.exports=a("aNFXt4")},{}],aNFXt4:[function(a,b,c){var d=a("../klass"),e=a("./tap").Tap,f=a("./longPress").LongPress,g=a("./singleTap").SingleTap,h=a("./doubleTap").DoubleTap,i=a("./swipe").Swipe,j=a("./drag").Drag,k=a("./pinch").Pinch,l={tap:{name:"Tap",klass:e},tapstart:{name:"Tap",klass:e},tapcancel:{name:"Tap",klass:e},longpress:{name:"LongPress",klass:f},longpressstart:{name:"LongPress",klass:f},longpresscancel:{name:"LongPress",klass:f},singletap:{name:"SingleTap",klass:g},singletapstart:{name:"SingleTap",klass:g},singletapcancel:{name:"SingleTap",klass:g},doubletap:{name:"DoubleTap",klass:h},doubletapstart:{name:"DoubleTap",klass:h},doubletapcancel:{name:"DoubleTap",klass:h},swipe:{name:"Swipe",klass:i},swipestart:{name:"Swipe",klass:i},swipemove:{name:"Swipe",klass:i},swipecancel:{name:"Swipe",klass:i},drag:{name:"Drag",klass:j},dragstart:{name:"Drag",klass:j},dragmove:{name:"Drag",klass:j},dragcancel:{name:"Drag",klass:j},pinch:{name:"Pinch",klass:k},pinchstart:{name:"Pinch",klass:k},pinchmove:{name:"Pinch",klass:k},pinchcancel:{name:"Pinch",klass:k}};c.isGesture=function(a){return"undefined"!=typeof l[a]};var m=d({$constructor:function(){this.evtHandlers=[]},startGesture:function(a,b,c){var d=l[a];if("undefined"!=typeof d){for(var e=!1,f=0,g=this.evtHandlers.length;g>f;f++)if(this.evtHandlers[f].name===d.name){e=!0;break}e||this.evtHandlers.push({name:d.name,instance:new d.klass(b,c)})}},$dispose:function(){for(var a=0,b=this.evtHandlers.length;b>a;a++)this.evtHandlers[a].instance.$dispose();this.evtHandlers=null}});b.exports.Gestures=m},{"../klass":"GfSJC6","./doubleTap":"6Kl1kt","./drag":"J6s4RB","./longPress":"OkCBHK","./pinch":"X+07de","./singleTap":"BxcBBq","./swipe":"1S2i7l","./tap":"uETHOu"}],OkCBHK:[function(a,b){var c=a("../klass"),d=a("./touchEvent"),e=a("./gesture").Gesture,f=c({$extends:e,MARGIN:10,PRESS_DURATION:1e3,_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:this._longPressStart.bind(this)}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:this._longPressMove.bind(this)},{evt:this.touchEventMap.touchend,cb:this._longPressCancel.bind(this)}]},_getFakeEventsMap:function(){return{start:"longpressstart",finalize:"longpress",cancel:"longpresscancel"}},_longPressStart:function(a){var b=this._gestureStart(a);if(null!=b){var c=this,d={};for(var e in a)d[e]=a[e];return this.timerId=setTimeout(function(){c._longPressFinalize(d)},this.PRESS_DURATION),b}return this.timerId?this._longPressCancel(a):null!=a.returnValue?a.returnValue:!a.defaultPrevented},_longPressMove:function(a){var b=d.getPositions(a);if(this.MARGIN>=this._calculateDistance(this.startData.positions[0].x,this.startData.positions[0].y,b[0].x,b[0].y)){var c=this._gestureMove(a);return null==c?this._longPressCancel(a):c}return this._longPressCancel(a)},_longPressCancel:function(a){return this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this._gestureCancel(a)},_longPressFinalize:function(a){this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this._gestureEnd(a),this._raiseFakeEvent(a,this._getFakeEventsMap().finalize)}});b.exports.LongPress=f},{"../klass":"GfSJC6","./gesture":"xsjChN","./touchEvent":"oYuPY+"}],"hsp/gestures/longPress":[function(a,b){b.exports=a("OkCBHK")},{}],"X+07de":[function(a,b){var c=a("../klass"),d=a("./touchEvent"),e=a("./gesture").Gesture,f=c({$extends:e,NB_TOUCHES:2,_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:this._pinchStart.bind(this)}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:this._pinchMove.bind(this)},{evt:this.touchEventMap.touchend,cb:this._pinchEnd.bind(this)}]},_getFakeEventsMap:function(){return{start:"pinchstart",move:"pinchmove",end:"pinch",cancel:"pinchcancel"}},_pinchStart:function(a){if(a.touches&&a.touches.length>=2){var b=d.getPositions(a);this.primaryPoint=b[0],this.secondaryPoint=b[1]}else a.isPrimary?this.primaryPoint=d.getPositions(a)[0]:"undefined"!=typeof a.isPrimary&&a.isPrimary===!1&&(this.secondaryPoint=d.getPositions(a)[0]);if(a.touches&&a.touches.length>=2||"undefined"!=typeof a.isPrimary&&a.isPrimary===!1){var c=this._calculateDistance(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y),e=this.__calculateAngle(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y);return this.initialPinchData={distance:c,dVariation:0,angle:e},this.lastKnownAngle=e,this._gestureStart(a,this.initialPinchData)}return null!=a.returnValue?a.returnValue:!a.defaultPrevented},_pinchMove:function(a){if(a.touches&&a.touches.length>=2){var b=d.getPositions(a);this.primaryPoint=b[0],this.secondaryPoint=b[1]}else{if("undefined"==typeof a.isPrimary)return this.$raiseEvent({name:"pinchcancel"}),this._gestureCancel(a);a.isPrimary?this.primaryPoint=d.getPositions(a):this.secondaryPoint=d.getPositions(a)}var c=this._calculateDistance(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y),e=this.__calculateAngle(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y);this.lastKnownAngle=e;var f={distance:c,dVariation:c-this.initialPinchData.distance,angle:e};return this._gestureMove(a,f)},_pinchEnd:function(a){if(a.touches&&a.changedTouches&&(a.changedTouches.length||0)+(a.touches.length||0)>=2){var b=d.getPositions(a);this.primaryPoint=b[0],this.secondaryPoint=b[1]}if("undefined"!=typeof a.isPrimary&&(a.isPrimary?this.primaryPoint=d.getPositions(a):this.secondaryPoint=d.getPositions(a)),a.touches&&a.changedTouches&&(a.changedTouches.length||0)+(a.touches.length||0)>=2||"undefined"!=typeof a.isPrimary){var c=this._calculateDistance(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y),e=this.__calculateAngle(this.primaryPoint.x,this.primaryPoint.y,this.secondaryPoint.x,this.secondaryPoint.y);Math.abs(e-this.lastKnownAngle)>150&&(e=this.__calculateAngle(this.secondaryPoint.x,this.secondaryPoint.y,this.primaryPoint.x,this.primaryPoint.y));var f={distance:c,dVariation:c-this.initialPinchData.distance,angle:e};return this._gestureEnd(a,f)}return this._gestureCancel(a)},__calculateAngle:function(a,b,c,d){return 180*Math.atan2(d-b,c-a)/Math.PI}});b.exports.Pinch=f},{"../klass":"GfSJC6","./gesture":"xsjChN","./touchEvent":"oYuPY+"}],"hsp/gestures/pinch":[function(a,b){b.exports=a("X+07de")},{}],BxcBBq:[function(a,b){var c=a("../klass"),d=a("./touchEvent"),e=a("./gesture").Gesture,f=c({$extends:e,MARGIN:10,FINAL_DELAY:250,_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:this._singleTapStart.bind(this)}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:this._singleTapMove.bind(this)},{evt:this.touchEventMap.touchend,cb:this._singleTapEnd.bind(this)}]},_getFakeEventsMap:function(){return{start:"singletapstart",cancel:"singletapcancel",finalize:"singletap"}},_singleTapStart:function(a){if(this.timerId)return this._singleTapFinalCancel(a);var b=this._gestureStart(a);return null==b?null!=a.returnValue?a.returnValue:!a.defaultPrevented:b},_singleTapMove:function(a){var b=d.getPositions(a);if(this.MARGIN>=this._calculateDistance(this.startData.positions[0].x,this.startData.positions[0].y,b[0].x,b[0].y)){var c=this._gestureMove(a);return null==c?this._singleTapCancel(a):c}return this._singleTapCancel(a)},_singleTapEnd:function(a){var b=this._gestureEnd(a);if(null!=b){var c=this,d={};for(var e in a)d[e]=a[e];return this.timerId=setTimeout(function(){c._singleTapFinalize(d)},this.FINAL_DELAY),b}return this._singleTapCancel(a)},_singleTapCancel:function(a){return this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this._gestureCancel(a)},_singleTapFinalize:function(a){this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this._raiseFakeEvent(a,this._getFakeEventsMap().finalize)},_singleTapFinalCancel:function(a){return this.timerId&&(clearTimeout(this.timerId),this.timerId=null),this._raiseFakeEvent(a,this._getFakeEventsMap().cancel)}});b.exports.SingleTap=f},{"../klass":"GfSJC6","./gesture":"xsjChN","./touchEvent":"oYuPY+"}],"hsp/gestures/singleTap":[function(a,b){b.exports=a("BxcBBq")},{}],"1S2i7l":[function(a,b){var c=a("../klass"),d=a("./touchEvent"),e=a("./gesture").Gesture,f=c({$extends:e,MARGIN:20,_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:this._swipeStart.bind(this)}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:this._swipeMove.bind(this)},{evt:this.touchEventMap.touchend,cb:this._swipeEnd.bind(this)}]},_getFakeEventsMap:function(){return{start:"swipestart",move:"swipemove",end:"swipe",cancel:"swipecancel"}},_swipeStart:function(a){var b=this._gestureStart(a);return null!=b?b:null!=a.returnValue?a.returnValue:!a.defaultPrevented},_swipeMove:function(a){var b=this._getRoute(this.startData.positions[0],d.getPositions(a)[0]);if(b){var c=this._gestureMove(a,b);return null!=c?c:this._swipeCancel(a)}return this._swipeCancel(a)},_swipeEnd:function(a){var b=this._getRoute(this.startData.positions[0],d.getPositions(a)[0]);if(b){var c=this._gestureEnd(a,b);return null!=c?c:this._swipeCancel(a)}return this._swipeCancel(a)},_swipeCancel:function(a){return this._gestureCancel(a)},_getRoute:function(a,b){var c=b.x-a.x,d=b.y-a.y,e=Math.abs(c),f=Math.abs(d),g=f>=e&&e<=this.MARGIN,h=e>f&&f<=this.MARGIN;return g?{direction:0>d?"up":"down",distance:f,startX:a.x,startY:a.y,endX:b.x,endY:b.y}:h?{direction:0>c?"left":"right",distance:e,startX:a.x,startY:a.y,endX:b.x,endY:b.y}:!1}});b.exports.Swipe=f},{"../klass":"GfSJC6","./gesture":"xsjChN","./touchEvent":"oYuPY+"}],"hsp/gestures/swipe":[function(a,b){b.exports=a("1S2i7l")},{}],uETHOu:[function(a,b){var c=a("../klass"),d=a("./touchEvent"),e=a("./gesture").Gesture,f=c({$extends:e,MARGIN:10,_getInitialListenersList:function(){return[{evt:this.touchEventMap.touchstart,cb:this._tapStart.bind(this)}]},_getAdditionalListenersList:function(){return[{evt:this.touchEventMap.touchmove,cb:this._tapMove.bind(this)},{evt:this.touchEventMap.touchend,cb:this._tapEnd.bind(this)}]},_getFakeEventsMap:function(){return{start:"tapstart",end:"tap",cancel:"tapcancel"}},_tapStart:function(a){var b=this._gestureStart(a);return null==b?null!=a.returnValue?a.returnValue:!a.defaultPrevented:b},_tapMove:function(a){var b=d.getPositions(a);if(this.MARGIN>=this._calculateDistance(this.startData.positions[0].x,this.startData.positions[0].y,b[0].x,b[0].y)){var c=this._gestureMove(a);return null==c?this._gestureCancel(a):c}return this._gestureCancel(a)},_tapEnd:function(a){var b=this._gestureEnd(a);return null==b?this._gestureCancel(a):null!=a.returnValue?a.returnValue:!a.defaultPrevented}});b.exports.Tap=f},{"../klass":"GfSJC6","./gesture":"xsjChN","./touchEvent":"oYuPY+"}],"hsp/gestures/tap":[function(a,b){b.exports=a("uETHOu")},{}],"hsp/gestures/touchEvent":[function(a,b){b.exports=a("oYuPY+")},{}],"oYuPY+":[function(a,b,c){function d(){var a={touchstart:"touchstart",touchend:"touchend",touchmove:"touchmove"},b="ontouchstart"in window||window.DocumentTouch&&window.document instanceof window.DocumentTouch;return b||(a={touchstart:"mousedown",touchend:"mouseup",touchmove:"mousemove"}),window.navigator.msPointerEnabled&&(a={touchstart:"MSPointerDown",touchend:"MSPointerUp",touchmove:"MSPointerMove"}),a}function e(a){return a=a.toLowerCase(),h[a]||a}var f=c.touchEventMap=d();c.getPositions=function(a){var b=[];if(a.touches&&a.touches[0]||a.changedTouches&&a.changedTouches[0]){for(var c=0;c<a.touches.length;c++)b.push({x:a.touches[c].pageX?a.touches[c].pageX:a.touches[c].clientX,y:a.touches[c].pageY?a.touches[c].pageY:a.touches[c].clientY});if(a.type==f.touchend)for(var c=0;c<a.changedTouches.length;c++)b.push({x:a.changedTouches[c].pageX?a.changedTouches[c].pageX:a.changedTouches[c].clientX,y:a.changedTouches[c].pageY?a.changedTouches[c].pageY:a.changedTouches[c].clientY})}else b.push({x:a.pageX?a.pageX:a.clientX,y:a.pageY?a.pageY:a.clientY});return b},c.getFingerIndex=function(a){var b=0;if(window.navigator.msPointerEnabled)b=a.isPrimary?0:1;else if(a.touches||a.changedTouches)if(a.changedTouches.length>1)b=100+a.changedTouches.length;else if(a.type==f.touchend)b=a.touches.length+a.changedTouches.length-1;else for(var c=a.changedTouches[0].pageX?a.changedTouches[0].pageX:a.changedTouches[0].clientX,d=a.changedTouches[0].pageY?a.changedTouches[0].pageY:a.changedTouches[0].clientY,e=0;e<a.touches.length;e++)if(c==(a.touches[e].pageX?a.touches[e].pageX:a.touches[e].clientX)&&d==(a.touches[e].pageY?a.touches[e].pageY:a.touches[e].clientY)){b=e;break}return b};var g={target:"srcElement",type:"type",clientX:"clientX",clientY:"clientY",altKey:"altKey",ctrlKey:"ctrlKey",shiftKey:"shiftKey",pageX:"pageX",pageY:"pageY",relatedTarget:"relatedTarget",button:"button",direction:"direction",distance:"distance",duration:"duration",startX:"startX",startY:"startY",endX:"endX",endY:"endY",detail:"detail",wheelDelta:"wheelDelta",wheelDeltaX:"wheelDeltaX",wheelDeltaY:"wheelDeltaY",screenX:"screenX",screenY:"screenY",touches:"touches",changedTouches:"changedTouches",targetTouches:"targetTouches",isPrimary:"isPrimary"},h={focusin:"focus",focusout:"blur",dommousescroll:"mousewheel",webkitanimationstart:"animationstart",oanimationstart:"animationstart",msanimationstart:"animationstart",webkitanimationiteration:"animationiteration",oanimationiteration:"animationiteration",msanimationiteration:"animationiteration",webkitanimationend:"animationend",oanimationend:"animationend",msanimationend:"animationend",webkittransitionend:"transitionend",otransitionend:"transitionend",mstransitionend:"transitionend"};c.getFakeEvent=function(a,b){var c=window.navigator?window.navigator.userAgent.toLowerCase():"",d=c.indexOf("gecko")>-1,f=!1;if(/msie[\/\s]((?:\d+\.?)+)/.test(c)){var h=RegExp.$1,i=parseInt(h,10);if(i>=7){var j=window.document.documentMode||7;j!=i&&(i=j)}f=8>=i}var k={},l={type:a};if(f&&window.event){l=window.event;for(var m in g)g.hasOwnProperty(m)&&(k[m]=l[g[m]]);"mouseout"==l.type?k.relatedTarget=l.toElement:"mouseover"==l.type&&(k.relatedTarget=l.fromElement)}else for(var m in g)g.hasOwnProperty(m)&&(k[m]=l[m]);if(k.type=e(l.type),k.charCode=0,k.keyCode=0,"keydown"==k.type||"keyup"==k.type)k.keyCode=l.keyCode,k.isSpecialKey=k.isSpecialKey(this.keyCode,l);else if("keypress"==k.type){var n=l.keyCode||l.charCode,o=d&&l.keyCode;k.keyCode=n,o||(k.keyCode=n,n>32&&38>n&&(k.keyCode=n+16),n>41&&48>n&&(k.keyCode=n+64),n>47&&58>n&&(k.keyCode=n+48),n>96&&123>n&&(k.keyCode=n-32)),k.charCode=n,k.isSpecialKey=k.isSpecialKey(this.keyCode,l)}return k.hasStopPropagation=!1,k.hasPreventDefault=!1,k.preventDefault=l.preventDefault?function(a){k.hasPreventDefault=!0,l.preventDefault(),a===!0&&k.stopPropagation()}:function(a){k.hasPreventDefault=!0,l.returnValue=!1,a===!0&&k.stopPropagation()},k.stopPropagation=l.stopPropagation?function(){k.hasStopPropagation=!0,l.stopPropagation()}:function(){k.hasStopPropagation=!0,l.cancelBubble=!0},k._dispose=function(){l=null,k.preventDefault=null,k.stopPropagation=null},k.type=a,k.target=b,k}},{}],"hsp/json":[function(a,b){b.exports=a("YcvKH8")},{}],YcvKH8:[function(a,b){function c(a,b,c,d,e){return{type:e,object:a,name:b,newValue:c,oldValue:d}}function d(a,b){var c=a[g];if(c)for(var d,e=0,f=c.length;f>e;e++)d=c[e],d.constructor===Function&&d(b)}function e(a,b,c){"object"==typeof a&&(a[c]||(a[c]=[]),a[c].push(b))}function f(a,b,c){if("object"==typeof a){var d=a[c];if(d){for(var e,f=[],g=0,h=d.length;h>g;g++)e=d[g],e!==b&&f.push(e);0===f.length?delete a[c]:a[c]=f}}}var g="+json:observers",h=Array.prototype,i=h.splice,j=h.push,k=h.shift,l=h.pop,m=h.reverse,n=h.sort,o=h.unshift;Array.prototype.splice=function(a){if(this[g]){var b=this.length,e=i.apply(this,arguments),f=this.length,h=[c(this,a,null,null,"splice")];return b!==f&&h.push(c(this,"length",f,b,"updated")),d(this,h),e}return i.apply(this,arguments)},Array.prototype.splice2=function(a,b,e){var f=this.length;e||(e=[]),e.splice(0,0,a,b);var h=i.apply(this,e);if(this[g]){var j=this.length,k=[c(this,a,null,null,"splice")];f!==j&&k.push(c(this,"length",j,f,"updated")),d(this,k)}return h},Array.prototype.push=function(){if(this[g]){var a,b,e=arguments,f=e.length,h=this.length,i=[];if(1>f)return h;if(1==f)b=j.call(this,e[0]),i.push(c(this,h,e[0],null,"new"));else{for(var k=0;f>k;k++)a=e[k],i[f-k-1]={type:"new",object:this,name:h+k,newValue:a};b=j.apply(this,e)}return h!==b&&i.push(c(this,"length",b,h,"updated")),d(this,i),b}return j.apply(this,arguments)},Array.prototype.shift=function(){if(this[g]){var a=this.length,b=k.call(this),e=this.length,f=[c(this,0,null,null,"shift")];return a!==e&&f.push(c(this,"length",e,a,"updated")),d(this,f),b}return k.call(this)},Array.prototype.unshift=function(){if(this[g]){var a=this.length;o.apply(this,arguments);var b=this.length,e=[c(this,0,null,null,"unshift")];return a!==b&&e.push(c(this,"length",b,a,"updated")),d(this,e),b}return o.apply(this,arguments)},Array.prototype.pop=function(){if(this[g]){var a=this.length,b=l.call(this),e=this.length,f=[c(this,0,null,null,"pop")];return a!==e&&f.push(c(this,"length",e,a,"updated")),d(this,f),b}return l.call(this)},Array.prototype.reverse=function(){var a=m.call(this);return d(this,[c(this,0,null,null,"reverse")]),a},Array.prototype.sort=function(a){var b;return b=a?n.call(this,a):n.call(this),d(this,[c(this,0,null,null,"sort")]),b};var p=Object.prototype.hasOwnProperty;b.exports={MD_OBSERVERS:g,$set:function(a,b,e){if(a[g]){var f=p.call(a,b),h=a[b],i=a.length,j=null;if(a[b]=e,f?h!==e&&(j=[c(a,b,e,h,"updated")]):j=[c(a,b,e,h,"new")],a.constructor===Array){var k=a.length;i!==k&&(j||(j=[]),j.push(c(a,"length",k,i,"updated")))}j&&d(a,j)}else a[b]=e;return e},$delete:function(a,b){if(a[g]){var e=p.call(a,b),f=a[b];if(delete a[b],e){var h=[c(a,b,a[b],f,"deleted")];d(a,h)}}else delete a[b]},observe:function(a,b){e(a,b,g)},unobserve:function(a,b){f(a,b,g)}},b.exports.set=b.exports.$set},{}],GfSJC6:[function(a,b){function c(){}function d(a){return Object.create?Object.create(a):(c.prototype=a,new c)}function e(){return g++,"+"+g+":"}var f=function(a){var b=a.$constructor;if(!b){var c=a.$extends;b=c?function(){c.apply(this,arguments)}:new Function,a.$constructor=b}if(a.$extends){if(!a.$extends.prototype)throw new Error("[klass] $extends attribute must be a function");var e=d(a.$extends.prototype);for(var f in a)a.hasOwnProperty(f)&&(e[f]=b[f]=a[f]);b.prototype=e}else{b.prototype=a;for(var f in a)a.hasOwnProperty(f)&&(b[f]=a[f])}return b};f.createObject=d;var g=0;f.createMetaDataPrefix=e,b.exports=f},{}],"hsp/klass":[function(a,b){b.exports=a("GfSJC6")},{}],D6s46z:[function(a,b){function c(a){for(var b,c=0,e=a.length;e>c;c++)b=a[c],b&&this.props[b.name]&&d(this,b,b.name);this.props[g]&&d(this,b,g)}function d(a,b,c){for(var d=a.props[c],e=0,f=d.length;f>e;e++)d[e].onPropChange(b)}var e=a("./klass"),f=a("./json"),g="**ALL**",h=e({$constructor:function(a){this.id=0,this.target=a,this.props={};var b=this;this.callback=function(a){c.call(b,a)},f.observe(a,this.callback)},$dispose:function(){f.unobserve(this.target,this.callback),this.props=null,this.callback=null,this.target=null},addObserver:function(a,b){b||(b=g);var c=this.props[b];c||(c=[],this.props[b]=c),c.push(a)},rmObserver:function(a,b){b||(b=g);var c=this.props[b];if(c){for(var d=0,e=c.length;e>d;d++)c[d]===a&&(c.splice(d,1),e-=1,d-=1);0===c.length&&(this.props[b]=null)}}});b.exports=h},{"./json":"YcvKH8","./klass":"GfSJC6"}],"hsp/propobserver":[function(a,b){b.exports=a("D6s46z")},{}],"7uFaOB":[function(a,b){function c(a,b){q[a]=function(a,c,d,e,f,g){return new b(a,c,d,e,f,g)}}a("./es5");var d=a("./klass"),e=a("./rt/log"),f=a("./rt/$root"),g=f.$RootNode,h=f.$InsertNode,i=f.$CptNode,j=f.$CptAttElement,k=a("./rt/cptwrapper"),l=d({$constructor:function(a){this.nodedefs=a},process:function(a,b,c,d){var e,f={},j=[];if(b)for(var k=0,l=b.length;l>k;k+=2)e=b[k],f[e]=b[k+1],j.push(e);f.scope=f;var m=null;return!a.$constructor||a.$constructor!==h&&a.$constructor!==i?m=new g(f,this.nodedefs,j,c,d):(m=a,m.init(f,this.nodedefs,j,c,d)),m}}),m=[],n=null,o=b.exports.refresh=function(){var a;for(n&&(clearTimeout(n),n=null);a=m.shift();)a.refresh()},p=function(){n=null,o()};o.addTemplate=function(a){var b=m.indexOf(a);0>b&&(m.push(a),n||(n=setTimeout(p,0)))},b.exports.display=function(a,b,c){if(b&&a){if(void 0===a.render||a.render.constructor!==Function)throw new Error("[hsp.display] Invalid argument: tplResult is not a valid template result");a.render(b,c)}},b.exports.template=function(a,b){var c=new l(null),d=[],g=0,h=!1,i=null;if(a.constructor===Array){g=a.length;for(var j=0;g>j;j++)d.push(a[j]),d.push(null)}else{h=!0,i=f.getObject(a.ctl);var m=null;if(null===i?m="Undefined component controller: "+a.ctl.slice(1).join("."):i.constructor!==Function&&(m="Component controller must be a function: "+a.ctl.slice(1).join(".")),m)throw e.error(m),m;d[0]=a.ref}var n=function(){var a=null,e=null;if(!c.nodedefs)try{c.nodedefs=b(q)}catch(f){throw f.constructor===ReferenceError?"Invalid reference: "+(f.message||f.description):f}if(h)a=k.createCptWrapper(i,arguments.length>1?arguments[1]:null),d[1]=a.cpt;else for(var j=0;g>j;j++)d[1+2*j]=arguments[j];return arguments.length>0&&(e=arguments[0]),c.process(this,d,a,e)};return n.isTemplate=!0,n.controllerConstructor=i,n},b.exports.logErrors=function(a,b){if(b&&b.length)for(var c,d,f=0,g=b.length;g>f;f++)c=b[f],d=null,c.lineInfoTxt?d=c.lineInfoTxt.replace(/\r?\n/gi,"\r\n>> "):c.code&&(d=c.code),e.error(c.description,{file:a,line:c.line,column:c.column,code:d})};for(var q={},r=["$text",a("./rt/$text"),"$if",a("./rt/$if"),"$insert",h,"$foreach",a("./rt/$foreach"),"elt",a("./rt/eltnode"),"cpt",i,"catt",j,"log",a("hsp/rt/$log"),"let",a("hsp/rt/$let")],s=0,t=r.length;t>s;s+=2)c(r[s],r[s+1])},{"./es5":"hhHoZL","./klass":"GfSJC6","./rt/$foreach":"Ll2sHF","./rt/$if":"R4WgDY","./rt/$root":"P5tgTj","./rt/$text":"jVbC+E","./rt/cptwrapper":"We0lgJ","./rt/eltnode":"NbaJkW","./rt/log":"pIlMhe","hsp/rt/$let":"3xKX24","hsp/rt/$log":"nUpGcG"}],"hsp/rt":[function(a,b){b.exports=a("7uFaOB")
},{}],"hsp/rt/$foreach":[function(a,b){b.exports=a("Ll2sHF")},{}],Ll2sHF:[function(a,b){var c=a("../klass"),d=a("./log"),e=a("../document"),f=a("../json"),g=a("./tnode"),h=g.TNode,i=g.isValidCptContent,j=c({$extends:h,$constructor:function(a,b,c,d,e,f){this.isDOMless=!0,this.itemName=c,this.itemKeyName=b,this.forType=0,this.colExpIdx=e,a["e"+e][0]=1,h.$constructor.call(this,a),this.displayedCol=null,this.itemNode=new k(f,c,b)},$dispose:function(){h.$dispose.call(this),this.root&&this.displayedCol&&this.root.rmObjectObserver(this,this.displayedCol),this.displayedCol=null},createNodeInstance:function(a){var b=h.createNodeInstance.call(this,a);b.TYPE="# foreach";var c=b.node;b.node1=e.createComment("# foreach"),b.node2=e.createComment("# /foreach"),c.appendChild(b.node1);var d=b.eh.getValue(b.colExpIdx,b.vscope,null);return b.createChildNodeInstances(d,c),c.appendChild(b.node2),b},createChildNodeInstances:function(a,b){var c,e=this.forType,f=this.itemNode;if(a)if(this.root.createObjectObserver(this,a),this.displayedCol=a,this.childNodes=c=[],0===e&&a.constructor!==Array&&(e=1),0===e)for(var g=a.length,h=0,i=0;g>h;h++)null!=a[h]&&void 0!==a[h]&&(c.push(f.createNodeInstance(this,a[h],i,0===i,i===g-1,b)),i++);else d.warning("[# foreach] Invalid iteration type: "+e)},refresh:function(){if(this.adirty){var a=this.eh.getValue(this.colExpIdx,this.vscope,null);if(a!==this.displayedCol||null===this.childNodes||0===this.childNodes.length){this.root.rmObjectObserver(this,this.displayedCol),this.deleteAllItems();var b=e.createDocumentFragment();this.createChildNodeInstances(a,b),this.node.insertBefore(b,this.node2);for(var c=0,d=this.childNodes.length;d>c;c++)this.childNodes[c].replaceNodeBy(b,this.node)}else this.updateCollection(a)}h.refresh.call(this)},updateCollection:function(a){for(var b=[],c=this.itemName,d=this.childNodes.length,f=a.length,g=0;d>g;g++)b[g]=this.childNodes[g].vscope[c];for(var h,i,j,k=[],l=0,m=Math.max(d,f),g=0;d>g;g++)if(h=b[g],f>g)if(i=a[g],null!=i&&void 0!==i){if(h!==i)if(k[g]){this.childNodes.splice(g,0,k[g]),b.splice(g,0,k[g].vscope[c]),d+=1;var n=this.node2;d-1>g&&(n=this.childNodes[g+1].node1),k[g].attachDOMNodesBefore(n),k[g]=null}else if(j=a.indexOf(h,g),j>g?(k[j]=this.childNodes[g],this.childNodes[g].detachDOMNodes(l),this.childNodes.splice(g,1)):l=this.deleteItem(g,l,!1),b.splice(g,1),d-=1,j=b.indexOf(i,g),j>=g){if(j!=g){this.moveItem(j,g,l,!1);var o=b.splice(j,1);b.splice(g,0,o)}}else{var p=this.createItem(i,g,0===g,g===m-1,e.createDocumentFragment()),q=this.node2;this.childNodes[g+1]&&(q=this.childNodes[g+1].node1),this.node.insertBefore(p.node,q),p.replaceNodeBy(p.node,this.node),b.splice(g,0,i),d+=1}}else a.splice(g,1),k.splice(g,1),f-=1,m=Math.max(d,f),g-=1;else i=null,l=this.deleteItem(g,l,!1),b.splice(g,1),g-=1,d-=1;if(this.resyncItemScopes(0,f-1),f>d)for(var g=d;f>g;g++)if(i=a[g],null!=i&&void 0!==i)if(k[g])this.childNodes.splice(g,0,k[g]),k[g].attachDOMNodesBefore(this.node2),k[g].updateScope(g,0===g,g===m-1),k[g]=null;else{var p=this.createItem(i,g,0===g,g===m-1,e.createDocumentFragment());this.node.insertBefore(p.node,this.node2),p.replaceNodeBy(p.node,this.node)}else a.splice(g,1),k.splice(g,1),f-=1;k=null},deleteItem:function(a,b,c){var d=this.childNodes[a],e=0;return d&&(this.childNodes.splice(a,1),e=d.detachDOMNodes(b),d.$dispose(),c!==!1&&this.resyncItemScopes(a)),e},deleteAllItems:function(){if(this.node.childNodes)for(var a=this.node,b=!1,c=a.childNodes,d=c.length,e=this.node1,f=this.node2,g=0;d>g;g++){var h=c[g];if(h!==e){if(b){if(h===f)break;a.removeChild(h),g-=1,d-=1}}else b=!0}if(this.childNodes){for(var c=this.childNodes,g=0,d=c.length;d>g;g++)c[g].$dispose();this.childNodes=null}},moveItem:function(a,b,c,d){var e,f=this.childNodes,g=f.length;if(!(a===b||a>g-1||b>g-1)){var h=this.node2;g-1>b&&(h=f[b].node1),e=f[a],f.splice(a,1),e.detachDOMNodes(c),f.splice(b,0,e),e.attachDOMNodesBefore(h),d!==!1&&this.resyncItemScopes(Math.min(a,b))}},createItem:function(a,b,c,d,e){var f=this.itemNode.createNodeInstance(this,a,b,c,d,e);return this.childNodes.splice(b,0,f),f},resyncItemScopes:function(a,b){var c=this.childNodes.length;a||(a=0),void 0===b&&(b=c-1);for(var d=a;c>d;d++)this.childNodes[d].updateScope(d,0===d,d===b)},isValidCptAttElement:function(){return this.itemNode.isValidCptAttElement()},toString:function(){return"[Foreach]"}}),k=c({$extends:h,$constructor:function(a,b,c){h.$constructor.call(this,0),this.isDOMless=!0,this.itemName=b,this.itemKeyName=c,a&&0!==a&&(this.children=a),this.detachedNodes=null},$dispose:function(){h.$dispose.call(this),this.node1=null,this.node2=null,this.detachedNodes=null},createNodeInstance:function(a,b,c,d,f,g){var i=this.createSubScope(a.vscope),j=this.itemName;i[j]=b,i[this.itemKeyName]=c,i[j+"_isfirst"]=d,i[j+"_islast"]=f;var k=h.createNodeInstance.call(this,a);k.TYPE="# item";var l=k.node;if(k.vscope=i,k.node1=e.createComment("# item"),k.node2=e.createComment("# /item"),g&&(k.node=l=g),l.appendChild(k.node1),this.children){k.childNodes=[];for(var m=0,n=this.children.length;n>m;m++)k.childNodes[m]=this.children[m].createNodeInstance(k)}return l.appendChild(k.node2),k},detachDOMNodes:function(a){a||(a=0);var b=a;if(!this.node.childNodes)return b;var b,c,d=this.node,e=!1,f=d.childNodes.length,g=this.node1,h=this.node2;if(!this.detachedNodes){this.detachedNodes=[];for(var i=a;f>i;i++)if(c=d.childNodes[i],c===g&&(e=!0),e&&(this.detachedNodes.push(c),d.removeChild(c),i-=1,c===h)){b=i;break}return b}},attachDOMNodesBefore:function(a){if(this.detachedNodes){var b=this.detachedNodes,c=b.length;if(!a||!this.detachedNodes)return;for(var d=e.createDocumentFragment(),f=0;c>f;f++)d.appendChild(b[f]);a.parentNode.insertBefore(d,a)}this.detachedNodes=null},updateScope:function(a,b,c){var d=this.vscope,e=this.itemName;f.set(d,this.itemKeyName,a),f.set(d,e+"_isfirst",b),f.set(d,e+"_islast",c)},isValidCptAttElement:function(){return i(this.children)},toString:function(){return"[Foreach item]"}});b.exports=j},{"../document":"WDacIY","../json":"YcvKH8","../klass":"GfSJC6","./log":"pIlMhe","./tnode":"Jrooar"}],R4WgDY:[function(a,b){var c=a("../klass"),d=a("../document"),e=a("./tnode"),f=e.TNode,g=e.isValidCptContent,h=c({$extends:f,$constructor:function(a,b,c,d){f.$constructor.call(this,a),this.isDOMless=!0,this.lastConditionValue=!1,this.isDOMempty=!0,this.condexpidx=b,c&&0!==c&&(this.children=c),d&&0!==d&&(this.children2=d)},createNodeInstance:function(a){var b=f.createNodeInstance.call(this,a),c=b.node;return b.TYPE="# if",b.node1=d.createComment("# if"),b.node2=d.createComment("# /if"),c.appendChild(b.node1),c.appendChild(b.node2),b.createChildNodeInstances(b.getConditionValue()),b},createChildNodeInstances:function(a){this.lastConditionValue=a,this.refScope||(this.refScope=this.vscope),this.isDOMempty||(this.removeChildNodeInstances(this.node1,this.node2),this.isDOMempty=!0),this.vscope=this.createSubScope(this.refScope);var b=a?this.children:this.children2;if(b){var c,e=b.length;if(e>0){this.childNodes=[];var f=d.createDocumentFragment();this.node=f;for(var g=0;e>g;g++)c=b[g].createNodeInstance(this),this.childNodes.push(c);this.replaceNodeBy(this.node,this.parent.node),this.node.insertBefore(f,this.node2),this.isDOMempty=!1}}},getConditionValue:function(){var a=!1;return this.eh&&(a=this.eh.getValue(this.condexpidx,this.vscope,!1)),a?!0:!1},refresh:function(){var a=this.getConditionValue();a!==this.lastConditionValue?(this.createChildNodeInstances(a),this.root.updateObjectObservers(this),this.adirty=!1,this.cdirty=!1):f.refresh.call(this)},isValidCptAttElement:function(){return g(this.children)&&g(this.children2)?!0:!1},toString:function(){return"[If]"}});b.exports=h},{"../document":"WDacIY","../klass":"GfSJC6","./tnode":"Jrooar"}],"hsp/rt/$if":[function(a,b){b.exports=a("R4WgDY")},{}],"hsp/rt/$let":[function(a,b){b.exports=a("3xKX24")},{}],"3xKX24":[function(a,b){var c=a("hsp/klass"),d=a("hsp/$set"),e=a("hsp/document"),f=a("hsp/rt/tnode").TNode,g=c({$extends:f,$constructor:function(a,b){f.$constructor.call(this,a),this.args=b},createNode:function(){this.node=e.createComment("{let}"),this.updateScope()},onPropChange:function(a){this.updateScope(),f.onPropChange.call(this,a)},updateScope:function(){var a,b=this.args,c=this.eh;if(b)for(var e=0,f=b.length;f>e;e+=2)a=c.getValue(b[e+1],this.vscope,void 0),d(this.vscope,b[e],a)},isValidCptAttElement:function(){return!0}});b.exports=g},{"hsp/$set":"+0srr9","hsp/document":"WDacIY","hsp/klass":"GfSJC6","hsp/rt/tnode":"Jrooar"}],"hsp/rt/$log":[function(a,b){b.exports=a("nUpGcG")},{}],nUpGcG:[function(a,b){var c=a("hsp/klass"),d=a("hsp/rt/log"),e=a("hsp/document"),f=a("hsp/rt/tnode").TNode,g=c({$extends:f,$constructor:function(a,b,c,d,e,g){f.$constructor.call(this,a),this.file="";var h=c.match(/[^\/\\]+$/);h&&h.length&&(this.file=h[0]),this.dir=d,this.line=e,this.column=g,this.args=b},createNode:function(){this.node=e.createComment("{log}"),this.processLog()},processLog:function(){var a,b=[],c=this.args,e=this.eh;if(this.args){for(var f=0,g=c.length;g>f;f++)a=e.getValue(c[f],this.vscope,void 0),b.push(a);b.push({type:"debug",file:this.file,dir:this.dir,line:this.line,column:this.column}),d.apply(null,b)}},refresh:function(){this.adirty&&this.processLog(),f.refresh.call(this)},isValidCptAttElement:function(){return!1}});b.exports=g},{"hsp/document":"WDacIY","hsp/klass":"GfSJC6","hsp/rt/log":"pIlMhe","hsp/rt/tnode":"Jrooar"}],P5tgTj:[function(a,b,c){var d=a("../klass"),e=a("./log"),f=a("../document"),g=a("../json"),h=a("../propobserver"),i=a("./tnode"),j=i.TNode,k=a("./cptcomponent"),l={$CptAttInsert:a("./cptattinsert").$CptAttInsert,$CptComponent:k.$CptComponent,$CptTemplate:a("./cpttemplate").$CptTemplate},m=11,n=d({$extends:j,$constructor:function(a,b,c,e,g){if(this.isInsertNode)j.$constructor.call(this,this.exps);else{j.$constructor.call(this,0);var h=f.createDocumentFragment();this.node=h,this.root=this}this.MD_ID=d.createMetaDataPrefix()+"oid",this.propObs=[],this.argNames=null,(a||b||c||e)&&this.init(a,b,c,e,g)},init:function(a,b,c,d,e){if(this.vscope=a,d)this.ctlWrapper=d,this.controller=d.cpt,this.ctlWrapper.init(e);else if(this.$constructor===q&&e)for(var f in e)a[f]=e[f];var g=[];if(b.constructor===Array)for(var h=0,i=b.length;i>h;h++)g.push(b[h].createNodeInstance(this));else g[0]=b.createNodeInstance(this);this.childNodes=g,this.argNames=c},$dispose:function(){for(var a,b=0,c=this.propObs.length;c>b;b++)a=this.propObs[b],delete a.target[this.MD_ID],a.$dispose();this.propObs=null,this.ctlWrapper&&(this.ctlWrapper.$dispose(),this.ctlWrapper=null,this.controller=null),j.$dispose.call(this)},createExpressionObservers:function(a){var b,c,d=a.vscope,e=a.eh;if(e)for(var f in e.exps)if(b=e.exps[f].getObservablePairs(e,d))if(c=b.length,1===c)this.createObjectObserver(a,b[0][0],b[0][1]);else{a.obsPairs=b;for(var g=0;c>g;g++)this.createObjectObserver(a,b[g][0],b[g][1])}},createObjectObserver:function(a,b,c){var d,e=b[this.MD_ID];if(e)d=this.propObs[e-1];else{d=new h(b);var f=this.propObs.length;this.propObs[f]=d,d.id=e=f+1,b[this.MD_ID]=e}d.addObserver(a,c)},rmObjectObserver:function(a,b,c){var d=b[this.MD_ID];if(d){var e=this.propObs[d-1];e.rmObserver(a,c)}},rmAllObjectObservers:function(a){var b=a.obsPairs;if(b){for(var c=0,d=b.length;d>c;c++)this.rmObjectObserver(a,b[c][0],b[c][1]);a.obsPairs=null}},updateObjectObservers:function(a){a.obsPairs&&(this.rmAllObjectObservers(a),this.createExpressionObservers(a))},updateArgument:function(a,b){g.set(this.vscope.scope,this.argNames[a],b)},render:function(a,b){var c=a;if("string"==typeof c){if(c=f.getElementById(c),null===c)return e.error("[hashspace] Template cannot be rendered - Invalid element id: "+a),this}else if(!c||!c.appendChild)return e.error("[hashspace] Template cannot be rendered - Invalid element: "+a),this;var d=this.node;return d.nodeType!==m?e.error("[hashspace] root element can only be appended once in the DOM"):(b!==!1&&(c.innerHTML=""),c.appendChild(d),this.replaceNodeBy(d,c)),this._triggersAfterRender(this),this},_triggersAfterRender:function(a){if(a.childNodes&&a.childNodes.length>0)for(var b=0;b<a.childNodes.length;b++)this._triggersAfterRender(a.childNodes[b]);a.controller&&a.controller.$afterRender&&a.controller.$afterRender()}}),o=c.getObject=function(a,b){var c=a[0],d=null,e=a.length;if(void 0===c||null===c||"string"==typeof c){if(b&&e>1&&(d=b[a[1]]),void 0===d||null===d)return null}else b&&e>1&&(d=b[a[1]]),d||(d=c);if(e>2)for(var f=2;e>f;f++)d=d[a[f]];return d},p=d({$extends:n,$constructor:function(a,b){this.isInsertNode=!0,this.isDOMless=!0,this.exps=a,n.$constructor.call(this),this.expIdx=b},$dispose:function(){n.$dispose.call(this),delete this.exps},createNodeInstance:function(a){var b=j.createNodeInstance.call(this,a),c=b.eh.getExpr(b.expIdx);return c&&c.getFuncRef?(c=c.getFuncRef(b.vscope,null),b.func=c.fn,b.tplArgs=c.args,b.isTemplate=b.func.isTemplate===!0,b.isTemplate?b.func.apply(b,b.getArguments()):(b.isDOMless=!1,b.node=f.createTextNode(b.getContent()),b.parent.node.appendChild(b.node))):e.error("[$InsertNode] Invalid template function"),b},getArguments:function(){for(var a=this.tplArgs,b=[],c=this.eh,d=0,e=a.length;e>d;d+=2)b.push(a[d]?c.getValue(a[d+1],this.vscope,null):a[d+1]);return b},getContent:function(){return this.isTemplate?"":this.func.apply({},this.getArguments())},refresh:function(){if(this.adirty){if(this.isTemplate)for(var a=this.parent.vscope,b=this.tplArgs,c=this.eh,d=0,e=0,f=b.length;f>d;d+=2,e++)b[d]&&this.updateArgument(e,c.getValue(b[d+1],a,null));else this.node.nodeValue=this.getContent();this.adirty=!1}j.refresh.call(this)}}),q=d({$extends:n,$constructor:function(a,b,c,d,e){this.pathInfo=a.slice(1).join("."),this.isCptNode=!0,this.attEltNodes=null,this.tplPath=a,this.isInsertNode=!0,this.isDOMless=!0,this.exps=b,this.attcfg=c,n.$constructor.call(this),this.createAttList(c,d),this.controller=null,this.ctlAttributes=null,this._scopeChgeCb=null,this.template=null,e&&0!==e&&(this.children=e)},$dispose:function(){this.cleanObjectProperties()},cleanObjectProperties:function(){this.removePathObservers(),this._scopeChgeCb&&(g.unobserve(this.vscope,this._scopeChgeCb),this._scopeChgeCb=null),n.$dispose.call(this),this.exps=null,this.controller=null,this.ctlAttributes=null,this.template=null},createNodeInstance:function(a){var b=null,c=a.vscope,d=this.tplPath,e=o(d,c);if(e&&"function"==typeof e?(this.template=e,b=e.controllerConstructor?this.createCptInstance("$CptComponent",a):this.createCptInstance("$CptTemplate",a),b.initCpt({template:e,ctlConstuctor:e.controllerConstructor})):e&&e.isCptAttElement&&(b=this.createCptInstance("$CptAttInsert",a),b.initCpt(e)),!b)throw new Error(this+" Invalid component reference");return b},createCptInstance:function(a,b){this.cptTypes||(this.cptTypes={});var c=this.cptTypes[a];if(!c){var e=l[a],f=d.createObject(this);for(var g in e)e.hasOwnProperty(g)&&(f[g]=e[g]);c=f,this.cptTypes[a]=c}var h=d.createObject(c);return h.vscope=b.vscope,h.parent=b,h.nodeNS=b.nodeNS,h.root=b.root,h.root.createExpressionObservers(h),h.node=h.parent.node,h},onAttributeChange:function(a){var b=-1,c=this.attcfg[a.name];if(c&&c.constructor===Array&&2===c.length&&""===c[0]&&(b=c[1]),b>-1){var d=this.eh.getExpr(b);d.bound&&d.setValue&&d.setValue(this.parent.vscope,a.newValue)}},refresh:function(){if(this.adirty){var a=!1;if(this.template){var b=o(this.tplPath,this.parent.vscope);a=b!==this.template}a?(this.template=b,this.createChildNodeInstances()):this.refreshAttributes&&this.refreshAttributes(),this.adirty=!1}j.refresh.call(this)},getPathObjects:function(){var a,b=this.tplPath,c=this.parent.vscope,d="string"==typeof b[0];if(c[b[1]]?a=this.getScopeOwner(b[1],c):(void 0===b[0]||null===b[0]||d)&&(d?(a=this.getScopeOwner(b[0],c),null===a&&(a=c)):a=c),a){var e=b.length,f=[];f.push(a);for(var g=1;e>g;g++){if(a=a[b[g]],void 0===a||null===a)return null;f.push(a)}return f}return null},createPathObservers:function(){var a=this.getPathObjects();if(!a||!a.length)return!1;var b=a.length;this._pathChgeCb=this.onPathChange.bind(this);for(var c=0;b>c;c++)g.observe(a[c],this._pathChgeCb);return this._observedPathObjects=a,!0},removePathObservers:function(){var a=this._observedPathObjects;if(a&&a.length){for(var b=0,c=a.length;c>b;b++)g.unobserve(a[b],this._pathChgeCb);this._observedPathObjects=null}this._pathChgeCb=null},onPathChange:function(){var a=this.getPathObjects(),b=this._observedPathObjects,c=a?a.length:-1,d=b?b.length:-1,e=!1;if(c===d&&-1!==c){for(var f=0;c>f;f++)if(a[f]!==b[f]){e=!0;break}}else-1!==c&&(e=!0);e&&(this.removePathObservers(),this.createPathObservers(),this.onPropChange())},getTemplateArguments:function(){var a={};if(this.atts)for(var b,c=this.parent.vscope,d=0,e=this.atts.length;e>d;d++)b=this.atts[d],a[b.name]=b.getValue(this.eh,c,null);return a},toString:function(){return"[Component: #"+this.pathInfo+"]"}}),r=d({$extends:q,isCptAttElement:!0,$constructor:function(a,b,c,d,e){this.name=a,this.tagName="@"+a,q.$constructor.call(this,[null,a],b,c,d,e),this.isCptAttElement=!0},$dispose:function(){j.$dispose.call(this)},isValidCptAttElement:function(){return!0},createNodeInstance:function(a){for(var b,c=a,d=!1;c;)if(c.isCptComponent){d=!0;var f=null,g=null;if(c.ctlElements&&(f=c.ctlElements[this.name]),c.ctlAttributes&&(g=c.ctlAttributes[this.name]),f||g)if(f){var h=f.type;"template"===h?b=j.createNodeInstance.call(this,a):"component"===h?f.controller?(b=this.createCptInstance("$CptComponent",a),b.initCpt({cptattelement:b,ctlConstuctor:f.controller,parentCtrl:c.controller})):e.error(this+" Controller property is mandatory for component elements"):e.error(this+" Invalid component element type: "+f.type)}else g&&"template"===g.type&&(b=j.createNodeInstance.call(this,a));else e.error(this+" Element not supported by its parent component");c=null}else c=c.parent;return d||e.error(this+" Attribute elements cannot be used outside components"),b},registerAttElements:function(a){a.push(this)},getTemplateNode:function(){return new n(this.vscope,this.children)},toString:function(){return"[Component attribute element: @"+this.name+"]"}});k.setDependency("$CptNode",q),k.setDependency("TNode",j),k.setDependency("$CptAttElement",r),c.$RootNode=n,c.$InsertNode=p,c.$CptNode=q,c.$CptAttElement=r},{"../document":"WDacIY","../json":"YcvKH8","../klass":"GfSJC6","../propobserver":"D6s46z","./cptattinsert":"C9wO2N","./cptcomponent":"lU3L0p","./cpttemplate":"aBMumZ","./log":"pIlMhe","./tnode":"Jrooar"}],"hsp/rt/$root":[function(a,b){b.exports=a("P5tgTj")},{}],"jVbC+E":[function(a,b){var c=a("../klass"),d=a("../document"),e=a("./tnode").TNode,f=a("./tnode").TExpAtt,g=c({$extends:e,$constructor:function(a,b){e.$constructor.call(this,a),this.textcfg=b,this.isEmptyTextNode=!1,this.isStatic&&(b?this.textcfg[0].match(/^\s*$/)&&(this.isEmptyTextNode=!0):(this.textcfg=[""],this.isEmptyTextNode=!0))},createNode:function(){this.node=d.createTextNode(this.getContent())},getContent:function(){var a=this.textcfg;return this.isStatic?a[0]:f.getValue.call(this,this.eh,this.vscope,"")},refresh:function(){this.adirty&&(this.node.nodeValue=this.getContent()),e.refresh.call(this)},isValidCptAttElement:function(){return this.isEmptyTextNode}});b.exports=g},{"../document":"WDacIY","../klass":"GfSJC6","./tnode":"Jrooar"}],"hsp/rt/$text":[function(a,b){b.exports=a("jVbC+E")},{}],C9wO2N:[function(a,b){b.exports.$CptAttInsert={initCpt:function(a){var b=a.getTemplateNode();this.childNodes=[],this.childNodes[0]=b,b.render(this.node,!1)},$dispose:function(){this.cleanObjectProperties()}}},{}],"hsp/rt/cptattinsert":[function(a,b){b.exports=a("C9wO2N")},{}],"hsp/rt/cptcomponent":[function(a,b){b.exports=a("lU3L0p")},{}],lU3L0p:[function(a,b,c){var d,e,f,g=a("../json"),h=a("./log"),i=a("../document"),j=a("./$text"),k=a("./cptwrapper");c.setDependency=function(a,b){"$CptAttElement"===a?e=b:"$CptNode"===a?d=b:"TNode"===a&&(f=b)},c.$CptComponent={initCpt:function(a){if(this.isCptComponent=!0,this.ctlConstuctor=a.ctlConstuctor,this.template){var b=this.createPathObservers();if(b){var c=this.node;this.node1=i.createComment("# cpt "+this.pathInfo),this.node2=i.createComment("# /cpt "+this.pathInfo),c.appendChild(this.node1),c.appendChild(this.node2),this.createChildNodeInstances()}else this.template.call(this,this.getTemplateArguments(),this.getCptArguments());this.initChildComponents()}else if(a.cptattelement){var d=k.createCptWrapper(this.ctlConstuctor,this.getCptArguments());this.ctlWrapper=d,this.controller=d.cpt,d.cpt.tagName&&h.error(this+" 'tagName' is a reserved keyword and cannot be used in component controllers"),d.cpt.tagName=this.tagName}},getCptArguments:function(){this.template&&(this.ctlConstuctor=this.template.controllerConstructor);var a=this.ctlConstuctor.prototype;this.ctlAttributes=a.attributes,this.ctlElements=a.elements,this.loadCptAttElements();var b,c={nodeInstance:this,attributes:{},content:null},d=c.attributes;if(this.atts){var e,f=this.atts,g=this.eh,h=this.vscope;if(f)for(var i=0,j=this.atts.length;j>i;i++)b=f[i],e=b.name,"template"!==this.ctlAttributes[e].type&&(d[e]=b.getValue(g,h,null))}if(this.tplAttributes){var k=this.tplAttributes;for(var l in k)k.hasOwnProperty(l)&&(d[l]=k[l])}return this.childElements&&(c.content=this.getControllerContent()),c},createChildNodeInstances:function(){if(this.isDOMempty||(this.removeChildNodeInstances(this.node1,this.node2),this.isDOMempty=!0),this.template){this.vscope=this.parent.vscope;var a=this.getTemplateArguments(),b=this.getCptArguments(),c=this.node,d=i.createDocumentFragment();this.node=d,this.template.call(this,a,b),this.node=c,this.node.insertBefore(d,this.node2),this.replaceNodeBy(d,c),this.isDOMempty=!1}},$dispose:function(){this.ctlWrapper&&(this.ctlWrapper.$dispose(),this.ctlWrapper=null,this.controller=null),this.ctlAttributes=null,this.cleanObjectProperties(),this.ctlConstuctor=null;var a=this.tplAttributes;if(a)for(var b in a)a.hasOwnProperty(b)&&a[b].$dispose();var c=this._attGenerators;if(c)for(var b in c)c.hasOwnProperty(b)&&c[b].$dispose();var d=this.attEltNodes;if(d){for(var e=0,f=d.length;f>e;e++)d[e].$dispose();this.attEltNodes=null}},loadCptAttElements:function(){this.attEltNodes=null,this._attGenerators=null;var a={},b=this.ctlAttributes,c=null,d=null,f=0;for(var g in b)b.hasOwnProperty(g)&&"template"===b[g].type&&(a[g]=!0,f++,b[g].defaultContent&&(c=g),d=g);c||(1===f?c=d:f>1&&(h.error(this+" A default content element must be defined when multiple content elements are supported"),c=d)),this.manageDefaultAttElt(c);var i,k,l=this.atts;if(l)for(var g in l)if(l.hasOwnProperty(g)&&(i=l[g],k=i.name,a[k]))if(this.tplAttributes&&this.tplAttributes[k])h.error(this+" Component attribute '"+k+"' is defined multiple times - please check");else{if(!i.generator){var m;m=i.value?new j(0,[""+i.value]):new j(this.exps,l[g].textcfg),this._attGenerators||(this._attGenerators=[]),i.generator=new e(k,0,0,0,[m]),this._attGenerators.push(i.generator)}var n=i.generator.createNodeInstance(this);n.isCptContent=!0,this.attEltNodes||(this.attEltNodes=[]),this.attEltNodes.push(n)}this.retrieveAttElements()},manageDefaultAttElt:function(a){if(this.children){for(var b=this.children,c=b.length,d=!1,f=!1,g=0;c>g;g++)b[g].isValidCptAttElement()?d=!0:f=!0;if(d&&f)h.error(this+"Component content cannot mix attribute elements with content elements");else{var i=!1;if(d&&!f)i=!0;else if(!d&&f&&a){var j=new e(a,0,0,0,this.children);this.children=[j],b=this.children,c=b.length,i=!0}if(i){var k;this.attEltNodes||(this.attEltNodes=[]);for(var g=0;c>g;g++)b[g].isEmptyTextNode||(k=b[g].createNodeInstance(this),k.isCptContent=!0,this.attEltNodes.push(k))}}}},retrieveAttElements:function(){var a=this.attEltNodes;if(!a)return null;for(var b=[],c=this.ctlAttributes,d=0,e=a.length;e>d;d++)a[d].registerAttElements(b);for(var f,g,i,j=[],k=this.ctlElements?this.ctlElements:[],d=0,e=b.length;e>d;d++)g=b[d],f=g.name,i=!0,c&&c[f]?(this.tplAttributes||(this.tplAttributes={}),this.tplAttributes[f]=g,i=!1):f?k[f]||(h.error(this+" Invalid attribute element: @"+f),i=!1):(h.error(this+" Invalid attribute element (unnamed)"),i=!1),i&&j.push(g);return 0===j.length&&(j=null),this.childElements=j,j},initChildComponents:function(){var a=this.childElements;if(a&&a.length)for(var b,c=0,d=a.length;d>c;c++)b=a[c].ctlWrapper,b&&!b.initialized&&b.init(null,this.controller)},getTplAttribute:function(a){var b=this.ctlAttributes;return b?b[a]:null},onEvent:function(a){var b=this.evtHandlers,c=a.type;if(b)for(var d=0,e=b.length;e>d;d++)if(b[d].evtType===c){b[d].executeCb(a,this.eh,this.parent.vscope);break}},replaceNodeBy:function(a,b){if(a!==b){f.replaceNodeBy.call(this,a,b);var c=this.attEltNodes;if(c)for(var d=0,e=c.length;e>d;d++)c[d].replaceNodeBy(a,b)}},getControllerContent:function(){var a,b=[],c=this.childElements,d=this.ctlElements;if(c&&c.length)for(var e=0,f=c.length;f>e;e++)a=d[c[e].name].type,"component"===a?b.push(c[e].controller):"template"===a?b.push(c[e]):h.error(this+" Invalid element type: "+a);return b.length>0?b:null},refresh:function(){if(this.edirty){var a=this.attEltNodes;if(a){for(var b=0,c=a.length;c>b;b++)a[b].refresh();this.retrieveAttElements(),this.initChildComponents()}g.set(this.controller,"content",this.getControllerContent()),this.edirty=!1}d.refresh.call(this)},refreshAttributes:function(){var a,b,c,d=this.atts,e=this.eh,f=this.controller,h=this.isCptAttElement?this.vscope:this.parent.vscope;if(this.adirty=!1,d&&f&&f.attributes)for(var i=0,j=this.atts.length;j>i;i++)a=d[i],b=f.attributes[a.name],"template"!==b.type&&0!==b._binding&&(c=a.getValue(e,h,null),""+c!=""+f[a.name]&&g.set(f,a.name,c))}}},{"../document":"WDacIY","../json":"YcvKH8","./$text":"jVbC+E","./cptwrapper":"We0lgJ","./log":"pIlMhe"}],"hsp/rt/cpttemplate":[function(a,b){b.exports=a("aBMumZ")},{}],aBMumZ:[function(a,b){var c=a("../json"),d=a("../document");b.exports.$CptTemplate={initCpt:function(a){var b=this.createPathObservers();if(b){var e=this.node;this.node1=d.createComment("# template "+this.pathInfo),this.node2=d.createComment("# /template "+this.pathInfo),e.appendChild(this.node1),e.appendChild(this.node2),this.createChildNodeInstances()}else a.template.call(this,this.getTemplateArguments());this._scopeChgeCb=this.onScopeChange.bind(this),c.observe(this.vscope,this._scopeChgeCb)},createChildNodeInstances:function(){if(this.isDOMempty||(this.removeChildNodeInstances(this.node1,this.node2),this.isDOMempty=!0),this.template){var a=this.getTemplateArguments(),b=this.node,c=d.createDocumentFragment();this.node=c,this.template.call(this,a),this.node=b,this.node.insertBefore(c,this.node2),this.replaceNodeBy(c,b),this.isDOMempty=!1}},$dispose:function(){this.cleanObjectProperties()},onScopeChange:function(a){a.constructor===Array&&a.length>0&&this.onAttributeChange(a[0])},refreshAttributes:function(){var a,b=this.atts,d=this.eh,e=this.parent.vscope;if(this.adirty=!1,b)for(var f=this.vscope,g=0,h=this.atts.length;h>g;g++)a=b[g],c.set(f,a.name,a.getValue(d,e,null))}}},{"../document":"WDacIY","../json":"YcvKH8"}],We0lgJ:[function(a,b,c){function d(a){return a}function e(a){var b=a.defaultValue,c=a.type;return void 0===b||"template"===c?j[c].defaultValue:j[c].convert(b,{type:"string"})}function f(a,b){var c=new l(a);if(b){var d=c.cpt,e=b.nodeInstance;if(e.isCptComponent||e.isCptAttElement){var f=b.attributes,i=b.content;if(c.nodeInstance=e,c.cpt.nodeInstance=e,f)for(var j in f)f.hasOwnProperty(j)&&g.set(d,j,f[j]);i&&(d.content?h.error(e+" Component controller cannot use 'content' for another property than child attribute elements"):g.set(d,"content",i))}}return c}var g=a("../json"),h=a("./log"),i=a("../klass"),j={"int":{defaultValue:0,convert:function(a,b){var c=parseInt(a,10);return isNaN(c)?e(b):c}},"float":{defaultValue:0,convert:function(a,b){var c=parseFloat(a);return isNaN(c)?e(b):c}},"boolean":{defaultValue:!0,convert:function(a){return a===!0||1===a||"1"===a||"true"===a}},string:{defaultValue:"",convert:function(a){return a+""}},object:{defaultValue:null,convert:d},callback:{defaultValue:null,convert:d},template:{defaultValue:null,convert:d}},k={none:0,"1-way":1,"2-way":2},l=i({$constructor:function(a){if(a&&a.constructor===Function){this.cpt=new a,this.nodeInstance=null,this.initialized=!1;var b,c,d=this.cpt.attributes;if(d)for(var e in d)b=d[e],e.match(/^on/)?b.type?"callback"!==b.type&&(h.error("Attribute type 'callback' should be set to '"+e+"' instead of: "+b.type),b.type="callback"):h.error("Attribute type 'callback' should be set to '"+e+"'"):(c=b.binding,c?(c=k[c],void 0!==c?b._binding=c:(h.error("Invalid attribute binding value: "+b.binding),b._binding=0)):b._binding=0,b.type?"callback"===b.type?h.error("Attribute of type 'callback' must start with 'on' - please rename: "+e):void 0===j[b.type]&&(h.error("Invalid attribute type: "+b.type),b.type="string"):b.type="string")}else h.error("[CptWrapper] Invalid Component constructor!")},$dispose:function(){this._cptChgeCb&&(g.unobserve(this.cpt,this._cptChgeCb),this._cptChgeCb=null);var a=this.cpt;a&&(a.$dispose&&a.$dispose(),a.nodeInstance=null,this.cpt=null),this.nodeInstance=null},init:function(a,b){if(!this.initialized){this.initialized=!0;var c=this.cpt,d=c.attributes;if(c){if(d){a||(a={});var e,f,i,k,l,m;for(var n in d)f=d[n],e=a[n],i="object"==typeof d[n],k=i&&d[n].type,k&&(m=j[f.type],m||(h.error("Invalid component attribute type: "+f.type),m=j.string)),"callback"!==f.type?("template"===f.type?l=null:(l="",void 0!==e?l=e:i?(l=f.defaultValue,void 0===l&&k&&(l=m.defaultValue)):l=f,k&&(l=m.convert(l,f))),c[n]||(c[n]=l)):this.createEventFunction(n.slice(2))}c.$init&&c.$init(b),this._cptChgeCb=this.onCptChange.bind(this),g.observe(c,this._cptChgeCb)}}},createEventFunction:function(a){var b=this;this.cpt["on"+a]=function(c){c||(c={}),c.type||(c.type=a),b.nodeInstance&&b.nodeInstance.onEvent&&b.nodeInstance.onEvent(c)}},onCptChange:function(a){var b=a,c=this.cpt;if(a.constructor===Array){if(!(a.length>0))return void h.error("[CptNode] Invalid change - nbr of changes: "+a.length);b=a[0]}var d=b.name;if(""!==d){var e=!0;if(c.attributes){var f=c.attributes[d],g=void 0!==f;if(g){var i=f.type;if(i){var k=j[i].convert(b.newValue,f);b.newValue=k,c[d]=k}}g&&this.nodeInstance&&2===f._binding&&(b.newValue=this.cpt[d],this.nodeInstance.onAttributeChange(b)),g&&0===f._binding&&(e=!1)}if(e){if(this.processingChange===!0)return;this.processingChange=!0;try{var l=["on",d.charAt(0).toUpperCase(),d.slice(1),"Change"].join("");c[l]&&c[l].call(c,b.newValue,b.oldValue)}finally{this.processingChange=!1}}}}});c.CptWrapper=l,c.createCptWrapper=f},{"../json":"YcvKH8","../klass":"GfSJC6","./log":"pIlMhe"}],"hsp/rt/cptwrapper":[function(a,b){b.exports=a("We0lgJ")},{}],"hsp/rt/eltnode":[function(a,b){b.exports=a("NbaJkW")},{}],NbaJkW:[function(a,b){var c=a("../klass"),d=a("../document"),e=a("./tnode").TNode,f=a("../rt"),g=a("../gestures/gestures"),h=c({$extends:e,$constructor:function(a,b,c,d,f,g){e.$constructor.call(this,b),this.tag=a,this.isInput="input"===this.tag,this.createAttList(c,d),f&&0!==f&&(this.children=f),this.gesturesEventHandlers=null,this.needSubScope=1===g},$dispose:function(){var a=this.evtHandlers,b=this.node;if(this.isInput&&(this.inputModelExpIdx=null),a)for(var c=void 0!==b.removeEventListener,d=0,f=a.length;f>d;d++)c?b.removeEventListener(a[d].evtType,this,!1):b.detachEvent("on"+a[d].evtType,this._attachEventFn);this.gesturesEventHandlers&&(this.gesturesEventHandlers.$dispose(),this.gesturesEventHandlers=null),this._attachEventFn=null,e.$dispose.call(this)},createNode:function(){this.TYPE=this.tag;var a;if("svg"===this.tag&&(this.nodeNS="http://www.w3.org/2000/svg"),this.nodeNS)a=d.createElementNS(this.nodeNS,this.tag);else if(this.atts&&this.atts.length>0){for(var b=null,c=null,e=0;e<this.atts.length;e++)"type"===this.atts[e].name&&(b=this.atts[e].value),"name"===this.atts[e].name&&(c=this.atts[e].value);if(b||c)try{a=d.createElement("<"+this.tag+(b?" type="+b:"")+(c?" name="+c:"")+" >")}catch(f){a=d.createElement(this.tag),b&&(a.type=b),c&&(a.name=c)}else a=d.createElement(this.tag)
}else a=d.createElement(this.tag);this.node=a,this.refreshAttributes();var h,i=this.evtHandlers,j=void 0!==a.addEventListener;if(i||this.isInput){if(!j){var k=this;this._attachEventFn=function(a){k.handleEvent(a)}}var l={};if(i)for(var e=0,m=i.length;m>e;e++)h=i[e],g.isGesture(h.evtType)?(null==this.gesturesEventHandlers&&(this.gesturesEventHandlers=new g.Gestures),this.gesturesEventHandlers.startGesture(h.evtType,a,this)):(l[h.evtType]=!0,j?a.addEventListener(h.evtType,this,!1):a.attachEvent("on"+h.evtType,this._attachEventFn));if(this.isInput){var n,o=["click","keydown","keyup"];for(var p in o)n=o[p],l[n]||(j?a.addEventListener(n,this,!1):a.attachEvent("on"+n,this._attachEventFn))}}},handleEvent:function(a){var b=this.evtHandlers,c=a.type,d=null;if(this.isInput&&this.inputModelExpIdx){var e=this.eh.getExpr(this.inputModelExpIdx);if(e.setValue){var g=this.node.value,h=this.node.type;"checkbox"===h&&(g=this.node.checked),this._lastValue=g,e.setValue(this.vscope,g),f.refresh()}}if(b)for(var i=0,j=b.length;j>i;i++)if(b[i].evtType===c){d=b[i].executeCb(a,this.eh,this.vscope);break}return d===!1&&a.preventDefault(),d},refresh:function(){this.adirty&&this.refreshAttributes(),e.refresh.call(this)},refreshAttributes:function(){var a,b,c=this.node,d=this.atts,e=this.eh,f=this.vscope,g=null;if(this.adirty=!1,d)for(var h=0,i=this.atts.length;i>h;h++)if(a=d[h],!this.isInput||this.inputModelExpIdx||"value"!==a.name&&"model"!==a.name||a.textcfg&&2===a.textcfg.length&&""===a.textcfg[0]&&(g||(g=[]),g[a.name]=a.textcfg[1]),b=a.name,"model"!==b)if("class"===b)this.nodeNS?c.setAttribute("class",a.getValue(e,f,"")):c.className=a.getValue(e,f,"");else if("value"===b)this.isInput&&"radio"!==c.type||(c.value=a.getValue(e,f,""));else try{c.setAttribute(a.name,a.getValue(e,f,null))}catch(j){}if(this.htmlCbs)for(var k,h=0,i=this.htmlCbs.length;i>h;h++)k=this.htmlCbs[h],c.setAttribute("on"+k.evtType,k.htmlCb);if(g){var l=g.model;l||(l=g.value),l&&(this.inputModelExpIdx=l)}if(this.inputModelExpIdx){var m=this.eh.getExpr(this.inputModelExpIdx),n=""+m.getValue(f,this.eh,"");if("radio"===c.type){var o=""+c.value;c.checked=n===o}else if("checkbox"===c.type){var o=""+c.checked;n!==o&&(c.checked=!c.checked)}else this._lastValue!==n&&(c.value=n),this._lastValue=null}}});b.exports=h},{"../document":"WDacIY","../gestures/gestures":"aNFXt4","../klass":"GfSJC6","../rt":"7uFaOB","./tnode":"Jrooar"}],FA9d2U:[function(a,b){var c=a("hsp/klass"),d=a("hsp/rt/log"),e=a("hsp/json"),f=c({$constructor:function(a){this.exps={};var b,c,e=null;for(var f in a)b=a[f],b.constructor===Array?(c=b[0],5===c?e=new g(b):0===c||1===c||2===c?e=new h(b):3===c||4===c?e=new i(b):6===c?e=new j(b,this):d.warning("Unsupported expression type: "+c),e&&(this.exps[f]=e)):d.warning("Unsupported expression definition: "+b)},getValue:function(a,b,c){return this.exps["e"+a].getValue(b,this,c)},getExpr:function(a){return this.exps["e"+a]},getScopeOwner:function(a,b){for(var c=b;c;){if(c.hasOwnProperty(a))return c;c=c["+parent"]}return null},createSubScope:function(a){var b=c.createObject(a);return b.scope=b,b["+parent"]=a,b}});b.exports=f;var g=c({$constructor:function(a){this.value=a[1]},getValue:function(){return this.value},getObservablePairs:function(){return null}}),h=c({bound:!1,$constructor:function(a){var b,c,d=a[0],e=a[1],f=2===d||4===d,g=[];f?(b=a[2],g=a.slice(3,e+2),c=e-1):(b="scope",g=a.slice(2,e+2),c=e),this.bound=1===d,this.isLiteral=f,this.root=b,this.path=g,this.ppLength=c},getValue:function(a,b,c){var d=this.isLiteral?this.root:a[this.root],e=this.ppLength;if("undefined"==typeof d)return c;if(1===e)d=d[this.path[0]];else for(var f=this.path,g=0;e>g;g++)if(d=d[f[g]],void 0===d)return c;return void 0!==d?d:c},setValue:function(a,b){if(this.isLiteral&&this.ppLength<=0)d.warning("[DataRefExpr.setValue] Global literal values cannot be updated from the DOM - please use object referenes");else{var c=this.isLiteral?this.root:a[this.root],f=this.ppLength,g=!0;if(1>f)return;for(var h=0;f-1>h;h++)if(c=c[this.path[h]],void 0===c){g=!1;break}g&&e.set(c,this.path[f-1],b)}},getObservablePairs:function(a,b){if(!this.bound)return null;var c=this.ppLength,d=this.path;if(1>c)return null;var e=this.root;if(this.isLiteral||(e=f.getScopeOwner(d[0],b),null===e&&(e=b)),void 0===e)return null;if(1===c)return[[e,d[0]]];for(var g,h=[],i=0;c>i&&(g=d[i],h.push([e,g]),e=e[g],void 0!==e);i++);return h}}),i=c({$extends:h,$constructor:function(a){h.$constructor.call(this,a);var b=a[1]+2;this.args=a.length>b?a.slice(b):null},getFuncRef:function(a,b){var c=this.isLiteral?this.root:a[this.root],d=this.ppLength,e=null;if(!c)return b;if(1===d){if(e=c,c=c[this.path[0]],void 0===c)return b}else for(var f=this.path,g=0;d>g;g++)if(e=c,c=c[f[g]],void 0===c)return b;return{fn:c,scope:e,args:this.args}},getValue:function(a,b,c){var d=this.executeCb({},b,a);return void 0===d?c:d},executeCb:function(a,b,c){var e,f=this.getFuncRef(c,null);if(!f)return d.error("[hashspace event handler] Invalid callback context");if(e=f.fn,!e||e.constructor!==Function)return d.error("[hashspace event handler] Invalid callback function");var g=[],h=c.event;c.event=a;var i=this.args;if(i)for(var j=0,k=i.length;k>j;j+=2)g.push(0===i[j]?i[j+1]:b.getValue(i[j+1],c,null));return void 0===h?delete c.event:c.event=h,e.apply(f.scope,g)},getObservablePairs:function(a,b){var c=h.getObservablePairs.call(this,a,b);return c}}),j=c({$constructor:function(a,b){this.fn=a[1],this.eh=b;var c=a.length-2;this.args=c>0?a.slice(2):null},getValue:function(a,b,c){if(this.args){for(var d=[],e=0,f=this.args.length;f>e;e++)d[e]=this.eh.getValue(this.args[e],a,null);try{var g=this.fn.apply({},d);return g}catch(h){return c}}else try{return this.fn.call({})}catch(h){return c}},getObservablePairs:function(){return null}})},{"hsp/json":"YcvKH8","hsp/klass":"GfSJC6","hsp/rt/log":"pIlMhe"}],"hsp/rt/exphandler":[function(a,b){b.exports=a("FA9d2U")},{}],pIlMhe:[function(a,b){function c(a){if(!a||!a.length)return{items:[],metaData:{}};for(var b,c=[],d={},e=0,f=a.length;f>e;e++)b=a[e],e>0&&e===f-1?"object"==typeof b&&b.type&&"string"==typeof b.type&&i[b.type]?d=b:c[e]=b:c[e]=b;return{items:c,metaData:d}}function d(a,b,d){var f,b=c(b),i=b.items,j=b.metaData,k=i.length;if((d||!j.type)&&(j.type=a),0===k)j.message="";else if(1===k)j.message=g(i[0]);else{for(var l=[],m=0;k>m;m++)f=g(i[m]),""!==f&&l.push(f);j.message=l.join(" ")}if(h&&h.length)for(var n=!1,m=0,k=h.length;k>m&&!(n=!h[m](j));m++);else e(j)}function e(a){var b={info:"info",error:"error",warning:"warn",debug:"log"};void 0!==typeof console&&console[b[a.type]](j.format(a))}function f(a,b){return a>b?1:b>a?-1:0}function g(a,b){(void 0===b||null===b)&&(b=1);var c,d=typeof a;if(null===a)return"null";if(void 0===a)return"undefined";if("object"===d){if(b>0){var e=[];if(a.constructor===Array){for(var h=0,i=a.length;i>h;h++)c=a[h],e.push("string"==typeof c?h+':"'+g(c,b-1)+'"':h+":"+g(c,b-1));return"["+e.join(", ")+"]"}var j=[];for(var k in a)k.match(/^\+/)||j.push(k);j.sort(f);for(var h=0,i=j.length;i>h;h++)c=a[j[h]],e.push("string"==typeof c?j[h]+':"'+g(c,b-1)+'"':j[h]+":"+g(c,b-1));return"{"+e.join(", ")+"}"}return a.constructor===Array?"Array["+a.length+"]":a.constructor===Function?"Function":"Object"}return"function"===d?"Function":""+a}var h=[],i={debug:!0,error:!0,warning:!0,info:!0},j=function(){d("debug",arguments,!1)};j.addLogger=function(a){a&&h.unshift(a)},j.removeLogger=function(a){if(h&&h.length)for(var b=0,c=h.length;c>b;b++)h[b]===a&&(h.splice(b,1),c-=1,b-=1)},j.removeAllLoggers=function(){h=[]},j.getNbrOfLoggers=function(){return h.length},j.error=function(){d("error",arguments,!0)},j.warning=function(){d("warning",arguments,!0)},j.info=function(){d("info",arguments,!0)},j.format=function(a){var b=[];return b.splice(b.length,0,"[",a.type),a.file&&b.splice(b.length,0,": ",a.file),b.splice(b.length,0,"] ",a.message),(a.line||a.column)&&(b.splice(b.length,0," ("),a.line&&b.splice(b.length,0,"line:",a.line),a.column&&(a.line?b.splice(b.length,0,", column:",a.column):b.splice(b.length,0,"column:",a.column)),b.splice(b.length,0,")")),a.code&&b.splice(b.length,0,"\r\n>> ",a.code),b.join("")},b.exports=j},{}],"hsp/rt/log":[function(a,b){b.exports=a("pIlMhe")},{}],"hsp/rt/tnode":[function(a,b){b.exports=a("Jrooar")},{}],Jrooar:[function(a,b){function c(a){if(!a)return!0;for(var b=0,c=a.length;c>b;b++)if(!a[b].isValidCptAttElement())return!1;return!0}var d=a("../rt"),e=a("../klass"),f=a("./log"),g=a("./exphandler"),h=e({node:null,vscope:null,root:null,parent:null,children:null,childNodes:null,adirty:!1,cdirty:!1,edirty:!1,htmlCbs:null,nodeNS:null,isCptContent:!1,obsPairs:null,needSubScope:!1,$constructor:function(a){this.isStatic=0===a,this.isStatic||(this.eh=new g(a))},$dispose:function(){var a=this.childNodes;if(a){for(var b=0,c=a.length;c>b;b++)a[b].$dispose();delete this.childNodes}this.root&&this.root.rmAllObjectObservers(this),this.obsPairs=null,this.htmlCbs=null,this.node=null,this.parent=null,this.root=null,this.vscope=null,this.children=null,this.atts=null,this.evtHandlers=null},createAttList:function(a,b){if(b){var c,d=[];for(var e in b)c=new k(e,b[e]),c.isHtmlCallback&&(this.htmlCbs||(this.htmlCbs=[]),this.htmlCbs.push(c)),d.push(c);this.evtHandlers=d}if(null===a||0===a)return null;var g,h=[];for(var e in a)a.hasOwnProperty(e)&&(g=a[e],null===g?h.push(new i(e,e)):"string"==typeof g?h.push(new i(e,g)):g.constructor===Array?h.push(new j(e,g)):f.error("[TNode] unsupported attribute: "+g));this.atts=h},onPropChange:function(){var a=this.root;this.adirty||(this.adirty=!0,this===a&&d.refresh.addTemplate(this)),this.isCptContent&&(this.parent.edirty=!0);for(var b=this.parent;b;)b.isCptContent&&b.parent&&(b.parent.edirty=!0),b.cdirty?b=null:(b.cdirty=!0,b===a&&d.refresh.addTemplate(b),b=b.parent)},createNodeInstance:function(a){var b=e.createObject(this);if(b.parent=a,b.vscope=this.needSubScope?b.createSubScope():a.vscope,b.nodeNS=a.nodeNS,b.root=a.root,b.root.createExpressionObservers(b),this.isDOMless)b.node=b.parent.node;else if(b.createNode(),b.parent.node&&b.parent.node.appendChild(b.node),this.children){b.childNodes=[];for(var c=0,d=this.children.length;d>c;c++)b.childNodes[c]=this.children[c].createNodeInstance(b)}return b},refresh:function(){if(this.adirty&&(this.root.updateObjectObservers(this),this.adirty=!1),this.cdirty){var a=this.childNodes;if(a)for(var b=0,c=a.length;c>b;b++)a[b].refresh();this.cdirty=!1}},createNode:function(){},replaceNodeBy:function(a,b){if(a!==b&&this.node===a){this.node=b;var c=this.childNodes;if(c)for(var d=0,e=c.length;e>d;d++)c[d].replaceNodeBy(a,b)}},isValidCptAttElement:function(){return!1},registerAttElements:function(a){var b,c=this.childNodes;if(c)for(var d=0,e=c.length;e>d;d++)b=c[d],b.registerAttElements?b.registerAttElements(a):b.isEmptyTextNode||f.error(this+" Statement must not produce invalid attribute elements when used as component content")},removeChildNodeInstances:function(a,b){var c=this.childNodes;if(c){for(var d=0,e=c.length;e>d;d++)c[d].$dispose();delete this.childNodes}this.childNodes=null;for(var f,g=this.node,h=!1,i=a,j=b,d=g.childNodes.length-1;d>-1;d--)if(f=g.childNodes[d],h){if(f===i){d=-1;break}g.removeChild(f)}else f===j&&(h=!0)},createSubScope:function(a){return a||(a=this.parent.vscope),g.createSubScope(a)},getScopeOwner:function(a,b){return g.getScopeOwner(a,b)}}),i=e({$constructor:function(a,b){this.name=a,this.value=b},getValue:function(){return this.value}}),j=e({$constructor:function(a,b){this.name=a,this.textcfg=b},getValue:function(a,b,c){var d=this.textcfg,e=d.length,f=[];if(2===e&&""===d[0])return a.getValue(d[1],b,c);for(var g=0;e>g;g++)f.push(g%2?a.getValue(d[g],b,c):d[g]);return f.join("")}}),k=e({$constructor:function(a,b){this.evtType=a;var c="number"!=typeof b;c?(this.isHtmlCallback=!0,this.htmlCb=b):this.expIdx=b},executeCb:function(a,b,c){if(this.expIdx){var d=b.getExpr(this.expIdx);if(d)return d.executeCb(a,b,c)}}});b.exports.isValidCptContent=c,b.exports.TNode=h,b.exports.TSimpleAtt=i,b.exports.TExpAtt=j},{"../klass":"GfSJC6","../rt":"7uFaOB","./exphandler":"FA9d2U","./log":"pIlMhe"}]},{},["7uFaOB"]);